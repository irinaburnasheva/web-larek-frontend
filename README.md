# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Общая концепция
Приложение покупки товаров на основе паттерна MVP через событийно-ориентированный подход. "Общение" между моделями и отображениями осуществляется через централизованный брокер событий. 

## Описание базовых классов, их предназначение и функции

### Типы данных

 - Интерфейс ```IProduct``` описывает объект товара. В нем содержатся поля с данными по товару, полученные от сервера + признак наличия товара в корзине

    ```
    export interface IProduct {
        id: string;
        title: string;
        description: string;
        category: string;
        price: number | null;
        image: string;
        inBasket: boolean;
    }

    ```

 - Корзина описывается интерфейсом ```IBasket```. В ней содержаться данные списка товаров, которые добавлены в корзину и общая сумма за товары. У Корзины есть методы:
    * addProduct - для добавления товара в корзину,
    * deleteProduct - удаление товара из корзины,
    * clearBasket - метод очистыки корзины (нужен для того, чтобы очистить корзину после оформления заказа)

    ```
    export interface IBasket {
        items: IProduct[];
        total: number;

        addProduct(product: IProduct): void;
        deleteProduct(productId: string): void;
        clearBasket(): void;
    }
    ```

 - Заказ - описывается интерфейсом ```IOrder```. Заказ наполняется данными из объектов корзины, покупателя и выбранного типа оплаты

    ```
    interface IOrder {
        items: IProduct[];
        address: string;
        email: string;
        phone: string;
        payment: TPayment;
        total: number;
    }   
    ```

 - Для описания типов событий я приложении использован ```enum AppEvents```

    ```
    export enum AppEvents {
    CATALOG_ONLOAD = 'catalog:onload', //загрузка каталога товаров
    MODAL_SHOW = 'modal:show', //открытие модального окна
    MODAL_HIDE = 'modal:hide', //скрытие модального окна
    PRODUCT_SELECT = 'product:select', //выбор продукта из каталога
    PRODUCT_PREVIEW_SHOW = 'productPreview:show', //открытие модального окна с превьюшкой выбранного товара
    PRODUCT_ADD_BASKET = 'productPreview:addBasket', //добавление выбранного товара из превью в корзину
    BASKET_SHOW = 'basket:show', //открытие модального окна корзины
    ORDER_FORM_SHOW = 'orderForm:show', // открытие формы типа оплаты и адреса
    CONTACTS_FORM_SHOW = 'contactsForm:show', //открытие формы заполнения контактных данных
    ORDER_CONFIRM = 'order:confirm', //подтверждение оформления заказа
    ORDER_CLEAR = 'order:clear', //очистка данных заказа после оформления
    STATUS_CLOSE = 'orderStatus:close', //закрытие модального окна статуса оформления заказа
    ORDER_FORM_UPDATE = 'form:update', // обновление данных в форме доставки и адреса
    CONTACTS_FORM_UPDATE = 'form:update', //обновление данных в форме контактных данных
    }
    ```   

- Взаимодействие с сервером описано с помощью интерфейса ```ILarekApi```. В нем 3 метода: получение списка товаров для каталога, получение информации по товару по ID и создание заказа

    ```
    export interface ILarekApi {
            getProductsList: () => Promise<ICatalogProductListResult>;
            getProductData: (id: string) => Promise<IProduct>;
            createOrder: (confirmedOrder: IOrderConfirmed) => Promise<IOrderConfirmed>;
    }
    ```


### Базовый класс брокера событий ```EventsEmitter```

    Обеспечивает взаимодействие между объектами приложения на основании событий. Использует типы ```Subscriber``` (Подписчик) и ```EmitterEvent``` (Событие). 
    Основные методы:
    - ```on``` установить обработчик на событие
    - ```off``` снять обработчик с события
    - ```emit``` инициировать событие с данными

    Описан в ```/components/base/events.ts```

    Типы событий приложения описаны в ```enum AppEvents```

### Модели данных

На основании описанных интерфейсов имплементируются классы с реализацией методов. Классы вынесены в отдельную директорию ```/components/model```

Выделены основные классы с моделями данных:
 - Продукт
    Класс продукта предоставляет структуру данных по продукту компонентам приложения 
 - Каталог
    Класс предоставляющий данные и методы для отображения карточек продуктов
 - Корзина
    Класс с данными по продуктам в корзине
 - Заказ
    Данные заказа: способ оплаты, адрес и тд
 - Форма
    Для работы с данными которые заполняются в формах


### Модели отображения

Классы отображения используют данные из моделей и отрисовывают компоненты. Классы вынесены в отдельную директорию ```/components/view```

Выделены основные модели отображения
- Каталог
- Модальное окно
- Карточка продукта
- Превью карточки продукта
- Корзина
- Продукты в корзине
- Форма доставки и оплаты
- Форма контактов
- Окно статуса заказа (заказ успешно оформлен)



